ishom(mist, missed).
ishom(cereal, serial).
ishom(toe, tow).
ishom(beet, beat).
ishom(slay, sleigh).
ishom(dye, die).
ishom(fore, four).
ishom(draft, draught).
ishom(would, wood).
ishom(by, bye).
ishom(ate, eight).
ishom(overdo, overdue).
ishom(role, roll).
ishom(bell, belle).
ishom(might, mite).
ishom(see, sea).
ishom(band, banned).
ishom(baron, barren).
ishom(weather, whether).
ishom(cent, sent).
ishom(youre, your).
ishom(threw, through).
ishom(foot, foot).
ishom(coarse, course).
ishom(gored, gourd).
ishom(bow, bough).
ishom(dear, deer).
ishom(peal, peel).
ishom(pair, pear).
ishom(sort, sought).
ishom(flex, flecks).
ishom(billed, build).
ishom(principal, principle).
ishom(wail, whale).
ishom(break, brake).
ishom(groan, grown).
ishom(know, no).
ishom(gamble, gambol).
ishom(bail, bale).
ishom(heal, heel).
ishom(flew, flu).
ishom(ad, add).
ishom(census, sense).
ishom(steal, steel).
ishom(bald, bawled).
ishom(whos, whose).
ishom(lead, led).
ishom(cool, cool).
ishom(levee, levy).
ishom(i, eye).
ishom(suite, sweet).
ishom(spring, spring).
ishom(wood, would).
ishom(medal, meddle).
ishom(check, cheque).
ishom(oar, or).
ishom(great, grate).
ishom(bridal, bridle).
ishom(hi, high).
ishom(auger, augur).
ishom(rap, wrap).
ishom(bard, barred).
ishom(cheap, cheep).
ishom(baize, bays).
ishom(beer, bier).
ishom(brews, bruise).
ishom(mean, mean).
ishom(sole, soul).
ishom(tide, tied).
ishom(drop, drop).
ishom(duck, duck).
ishom(rock, rock).
ishom(stake, steak).
ishom(sail, sale).
ishom(way, weigh).
ishom(meat, meet).
ishom(wait, weight).
ishom(lain, lane).
ishom(cord, chord).
ishom(well, well).
ishom(cell, sell).
ishom(than, then).
ishom(farther, father).
ishom(fly, fly).
ishom(bee, be).
ishom(ring, ring).
ishom(heel, heal).
ishom(tear, tier).
ishom(bad, bade).
ishom(grate, great).
ishom(complement, compliment).
ishom(foul, fowl).
ishom(soar, sore).
ishom(scale, scale).
ishom(trip, trip).
ishom(capital, capitol).
ishom(heard, herd).
ishom(file, file).
ishom(altar, alter).
ishom(sun, son).
ishom(chili, chilly).
ishom(fir, fur).
ishom(urn, earn).
ishom(hall, haul).
ishom(stalk, stork).
ishom(some, sum).
ishom(vain, vein).
ishom(loot, lute).
ishom(knot, not).
ishom(root, route).
ishom(be, bee).
ishom(missed, mist).
ishom(hart, heart).
ishom(bored, board).
ishom(forth, fourth).
ishom(all, awl).
ishom(yoke, yolk).
ishom(discreet, discrete).
ishom(holy, wholly).
ishom(leak, leek).
ishom(bat, bat).
ishom(lessen, lesson).
ishom(right, write).
ishom(vary, very).
ishom(higher, hire).
ishom(for, four).
ishom(pedal, peddle).
ishom(plain, plane).
ishom(flower, flour).
ishom(made, maid).
ishom(pain, pane).
ishom(soot, suit).
ishom(towed, toad).
ishom(flea, flee).
ishom(sea, see).
ishom(file, phial).
ishom(bean, been).
ishom(braid, brayed).
ishom(mask, masque).
ishom(sale, sail).
ishom(incite, insight).
ishom(stare, stair).
ishom(gait, gate).
ishom(stile, style).
ishom(key, quay).
ishom(earn, urn).
ishom(son, sun).
ishom(palm, palm).
ishom(berth, birth).
ishom(rain, reign).
ishom(cellar, seller).
ishom(rung, wrung).
ishom(sink, sink).
ishom(marshal, martial).
ishom(vale, veil).
ishom(practice, practise).
ishom(ball, bawl).
ishom(ruler, ruler).
ishom(nail, nail).
ishom(flu, flue).
ishom(their, there).
ishom(match, match).
ishom(broach, brooch).
ishom(band, band).
ishom(stair, stare).
ishom(birth, berth).
ishom(rouse, rows).
ishom(won, one).
ishom(arc, ark).
ishom(none, nun).
ishom(bear, bare).
ishom(eye, i).
ishom(done, dun).
ishom(patience, patients).
ishom(fair, fare).
ishom(manna, manner).
ishom(berry, bury).
ishom(beach, beech).
ishom(ring, wring).
ishom(oar, ore).
ishom(knight, night).
ishom(pore, pour).
ishom(right, right).
ishom(ceiling, sealing).
ishom(muscle, mussel).
ishom(read, reed).
ishom(board, bored).
ishom(scull, skull).
ishom(whole, hole).
ishom(rose, rose).
ishom(ant, aunt).
ishom(foreword, forward).
ishom(red, read).
ishom(too, two).
ishom(waste, waist).
ishom(hoard, horde).
ishom(clip, clip).
ishom(meet, meat).
ishom(fool, full).
ishom(team, teem).
ishom(find, fined).
ishom(watch, watch).
ishom(fur, fir).
ishom(plane, plain).
ishom(fall, fall).
ishom(him, hymn).
ishom(air, heir).
ishom(maw, more).
ishom(scene, seen).
ishom(waist, waste).
ishom(peak, peek).
ishom(read, red).
ishom(beat, beet).
ishom(dun, done).
ishom(alms, arms).
ishom(one, won).
ishom(side, sighed).
ishom(allowed, aloud).
ishom(here, hear).
ishom(boar, bore).
ishom(flour, flower).
ishom(write, right).
ishom(sight, site).
ishom(point, point).
ishom(vein, vane).
ishom(coun, counsel).
ishom(can, can).
ishom(flaw, floor).
ishom(stalk, stalk).
ishom(to, too).
ishom(knead, need).
ishom(yore, your).
ishom(feat, feet).
ishom(sew, sow).
ishom(wear, where).
ishom(blue, blew).
ishom(hair, hare).
ishom(staid, stayed).
ishom(mail, male).
ishom(shoe, shoo).
ishom(links, lynx).
ishom(bare, bear).
ishom(address, address).
ishom(hour, our).
ishom(pray, prey).
ishom(passed, past).
ishom(park, park).
ishom(throne, thrown).
ishom(cite, sight).
ishom(to, two).
ishom(dual, duel).
ishom(weak, week).
ishom(seam, seem).
ishom(left, left).
ishom(told, tolled).
ishom(genes, jeans).
ishom(where, wear).
ishom(ail, ale).
ishom(tail, tale).
ishom(choral, coral).
ishom(vane, vain).
ishom(brake, break).
ishom(ewe, you).
ishom(rode, road).
ishom(too, to).
ishom(praise, prays).
ishom(date, date).
ishom(buy, by).
ishom(deer, dear).
ishom(loan, lone).
ishom(stationary, stationery).
ishom(which, witch).
ishom(faze, phase).
ishom(moose, mousse).
ishom(tie, tie).
ishom(rose, rows).
ishom(letter, letter).
ishom(aural, oral).
ishom(hole, whole).
ishom(profit, prophet).
ishom(wave, wave).
ishom(die, dye).
ishom(hear, here).
ishom(witch, which).
ishom(bough, bow).
ishom(sauce, seen).
ishom(saw, saw).
ishom(doe, dough).
ishom(boy, buoy).
ishom(fort, fought).
ishom(peace, piece).
ishom(idle, idol).
ishom(knew, new).
ishom(ship, ship).
ishom(main, mane).
ishom(road, rode).
ishom(pail, pale).

ishom([AH|AT],[BH|BT]):- ishom(AH,BH), ishom(AT,BT), !.
ishom(A,B) :- ishom(B,A).
ishom(A,B) :- ishom(A,C), ishom(C,B).

sentence("knock knock . who is there ? Nobel . Nobel who ?"). % matches all rules
sentence("knock knock . who is there ? Nobel . Incorrect who ?"). % does not match
% funny("knock knock . who is there ? Nobel Prize . Nobel Prize who ? Nobel Winner !").
% funny("knock knock . who is there ? i love . i love who ? i dont know you tell me !").

% generate all consecutive sub-lists of S in X
%
% append/3
% https://www.swi-prolog.org/pldoc/man?predicate=append/3
% param1 and param2 get combined into param3
%
% \=    equivalent to not equals
% https://www.swi-prolog.org/pldoc/man?predicate=%5C%3D/2
%
% This is pretty much appending one word to X at a time until it matches funnyFirst as long as X is not []
substring(X,S) :- append(_,T,S), append(X,_,T) , X \= [] , write('substring write: '), writeln(X).

funnyFirst([A, B, "."]) :- A=="knock", A==B. % first two words must be the same

funnySecond(["who", "is", "there", "?"]).% must match this exact list of words

% funnyThird([_, "."]). % any single word matches (followed by period)
%
funnyThird(S) :- last(S, ".").
% The | denotes a 'tail' or 'the rest of the list.'

% got this from stacked overflow
% https://stackoverflow.com/questions/16174681/how-to-delete-the-last-element-from-a-list-in-prolog
list_butlast([X|Xs], Ys) :-                 % use auxiliary predicate ...
   list_butlast_prev(Xs, Ys, X).            % ... which lags behind by one item

list_butlast_prev([], [], _).
list_butlast_prev([X1|Xs], [X0|Ys], X0) :-
   list_butlast_prev(Xs, Ys, X1).           % lag behind by one

%funnyFourth(Fourthpart, Thirdpart): first word of each part must match
% funnyFourth([A, "who", "?"|_], [A,"."]).
funnyFourth(S) :- last(S, "?"), list_butlast(S, X), last(X, "who").

checkThirdFourth(Third, Fourth) :- same(Third, Fourth).
same([], []).
same([H1|T1], [H2|T2]):-
    H1 = H2,
    same(T1, T2).

funnyMain(L) :-  substring(First,L),
  funnyFirst(First),
  append(First,Rest,L),

  writeln(''), write('funnyFirst matched: '), writeln(First),
  write('Here is the rest of the list: '), writeln(Rest), writeln(''),

  substring(Second,Rest),
  funnySecond(Second),
  append(Second,Rest2,Rest),

  writeln(''), write('funnySecond matched: '), writeln(Second),
  write('Here is the rest of the list: '), writeln(Rest2), writeln(''),

  substring(Third,Rest2),
  funnyThird(Third),
  append(Third,Rest3,Rest2),

  writeln(''), write('funnyThird matched: '), writeln(Third),
  write('Here is the rest of the list: '), writeln(Rest3),
  list_butlast(Third, NewThird),
  write("here is what we need to match: "), writeln(NewThird), writeln(''),

  substring(Fourth,Rest3),
  funnyFourth(Fourth),
  append(Fourth,Rest4,Rest3),

  writeln(''), write('funnyFourth matched: '), writeln(Fourth),
  write('Here is the rest of the list: '), writeln(Rest4),
  list_butlast(Fourth, NewFourth),
  list_butlast(NewFourth, NewNewFourth),
  write("here is what we need to match: "), writeln(NewNewFourth), writeln(''),

  writeln('Checking if Third and Fourth are the same.'),
  checkThirdFourth(NewThird, NewNewFourth),
  writeln('true'), writeln(''),

  writeln('Now comparing analyzing the rest of the list to determine humor.'),
  writeln(NewThird),
  writeln(Rest4),

  ishom(NewThird, Rest4),
  writeln('true'), writeln('')
  .

% ==== function docs ====
% string_split/4
% https://www.swi-prolog.org/pldoc/man?predicate=split_string/4
% This is ideally splitting up the sentence into a list to be processed
%
% write/1
% https://www.swi-prolog.org/pldoc/man?predicate=write/1
%
% writeln/1
% https://www.swi-prolog.org/pldoc/man?predicate=writeln/1
funny(S) :- split_string(S, " ", " ", L), write("L="),writeln(L), funnyMain(L).
