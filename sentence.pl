ishom("weather", "whether").
ishom("wood", "would").
ishom("barren", "baron").
ishom("lain", "lane").
ishom("wrap", "rap").
ishom("than", "then").
ishom("horde", "hoard").
ishom("ship", "ship").
ishom("bier", "beer").
ishom("stile", "style").
ishom("peek", "peak").
ishom("levee", "levy").
ishom("arc", "ark").
ishom("deer", "dear").
ishom("witch", "which").
ishom("address", "address").
ishom("week", "weak").
ishom("fir", "fur").
ishom("tolled", "told").
ishom("allowed", "aloud").
ishom("flu", "flew").
ishom("jeans", "genes").
ishom("threw", "through").
ishom("plane", "plain").
ishom("dun", "done").
ishom("knew", "new").
ishom("discrete", "discreet").
ishom("wring", "ring").
ishom("tie", "tie").
ishom("fly", "fly").
ishom("beech", "beach").
ishom("bale", "bail").
ishom("idle", "idol").
ishom("yolk", "yoke").
ishom("piece", "peace").
ishom("here", "hear").
ishom("heel", "heal").
ishom("loot", "lute").
ishom("ant", "aunt").
ishom("file", "phial").
ishom("missed", "mist").
ishom("or", "oar").
ishom("flea", "flee").
ishom("by", "buy").
ishom("match", "match").
ishom("soul", "sole").
ishom("aural", "oral").
ishom("fought", "fort").
ishom("weak", "week").
ishom("altar", "alter").
ishom("links", "lynx").
ishom("way", "weigh").
ishom("earn", "urn").
ishom("gait", "gate").
ishom("toe", "tow").
ishom("scale", "scale").
ishom("coral", "choral").
ishom("belle", "bell").
ishom("made", "maid").
ishom("watch", "watch").
ishom("insight", "incite").
ishom("meddle", "medal").
ishom("lynx", "links").
ishom("sort", "sought").
ishom("too", "to").
ishom("overdo", "overdue").
ishom("air", "heir").
ishom("letter", "letter").
ishom("genes", "jeans").
ishom("main", "mane").
ishom("band", "band").
ishom("road", "rode").
ishom("wave", "wave").
ishom("ore", "oar").
ishom("pail", "pale").
ishom("peace", "piece").
ishom("boar", "bore").
ishom("two", "to").
ishom("wrung", "rung").
ishom("saw", "saw").
ishom("practice", "practise").
ishom("forth", "fourth").
ishom("sore", "soar").
ishom("cool", "cool").
ishom("seller", "cellar").
ishom("sealing", "ceiling").
ishom("hour", "our").
ishom("urn", "earn").
ishom("augur", "auger").
ishom("sum", "some").
ishom("cite", "sight").
ishom("sew", "sow").
ishom("build", "billed").
ishom("lessen", "lesson").
ishom("wait", "weight").
ishom("bell", "belle").
ishom("weigh", "way").
ishom("seen", "sauce").
ishom("groan", "grown").
ishom("coun", "counsel").
ishom("peal", "peel").
ishom("role", "roll").
ishom("seen", "scene").
ishom("brooch", "broach").
ishom("board", "bored").
ishom("stayed", "staid").
ishom("staid", "stayed").
ishom("shoe", "shoo").
ishom("there", "their").
ishom("phase", "faze").
ishom("gourd", "gored").
ishom("knight", "night").
ishom("rung", "wrung").
ishom("meat", "meet").
ishom("stationery", "stationary").
ishom("bee", "be").
ishom("blue", "blew").
ishom("dye", "die").
ishom("arms", "alms").
ishom("lesson", "lessen").
ishom("bare", "bear").
ishom("haul", "hall").
ishom("billed", "build").
ishom("eight", "ate").
ishom("bade", "bad").
ishom("no", "know").
ishom("write", "right").
ishom("hart", "heart").
ishom("mite", "might").
ishom("tow", "toe").
ishom("won", "one").
ishom("grown", "groan").
ishom("cheep", "cheap").
ishom("doe", "dough").
ishom("new", "knew").
ishom("peddle", "pedal").
ishom("fool", "full").
ishom("flu", "flue").
ishom("eye", "i").
ishom("sun", "son").
ishom("sleigh", "slay").
ishom("cellar", "seller").
ishom("tail", "tale").
ishom("right", "right").
ishom("floor", "flaw").
ishom("masque", "mask").
ishom("overdue", "overdo").
ishom("trip", "trip").
ishom("lane", "lain").
ishom("census", "sense").
ishom("holy", "wholly").
ishom("band", "banned").
ishom("done", "dun").
ishom("flee", "flea").
ishom("higher", "hire").
ishom("pour", "pore").
ishom("fore", "four").
ishom("lead", "led").
ishom("bore", "boar").
ishom("capitol", "capital").
ishom("rouse", "rows").
ishom("your", "youre").
ishom("vale", "veil").
ishom("yoke", "yolk").
ishom("choral", "coral").
ishom("medal", "meddle").
ishom("cheque", "check").
ishom("father", "farther").
ishom("braid", "brayed").
ishom("alms", "arms").
ishom("nun", "none").
ishom("ate", "eight").
ishom("sole", "soul").
ishom("alter", "altar").
ishom("dual", "duel").
ishom("one", "won").
ishom("compliment", "complement").
ishom("four", "for").
ishom("too", "two").
ishom("coarse", "course").
ishom("flower", "flour").
ishom("meet", "meat").
ishom("male", "mail").
ishom("need", "knead").
ishom("rows", "rouse").
ishom("very", "vary").
ishom("baize", "bays").
ishom("counsel", "coun").
ishom("break", "brake").
ishom("lone", "loan").
ishom("roll", "role").
ishom("tear", "tier").
ishom("would", "wood").
ishom("stair", "stare").
ishom("ewe", "you").
ishom("fined", "find").
ishom("heard", "herd").
ishom("ruler", "ruler").
ishom("be", "bee").
ishom("dear", "deer").
ishom("heal", "heel").
ishom("throne", "thrown").
ishom("fowl", "foul").
ishom("side", "sighed").
ishom("marshal", "martial").
ishom("can", "can").
ishom("baron", "barren").
ishom("style", "stile").
ishom("chili", "chilly").
ishom("blew", "blue").
ishom("lute", "loot").
ishom("sense", "census").
ishom("bridal", "bridle").
ishom("cereal", "serial").
ishom("find", "fined").
ishom("buoy", "boy").
ishom("sell", "cell").
ishom("bat", "bat").
ishom("sow", "sew").
ishom("sea", "see").
ishom("martial", "marshal").
ishom("pedal", "peddle").
ishom("vary", "very").
ishom("flew", "flu").
ishom("serial", "cereal").
ishom("passed", "past").
ishom("oar", "or").
ishom("bawled", "bald").
ishom("loan", "lone").
ishom("praise", "prays").
ishom("steal", "steel").
ishom("phial", "file").
ishom("mean", "mean").
ishom("oral", "aural").
ishom("high", "hi").
ishom("key", "quay").
ishom("sale", "sail").
ishom("rows", "rose").
ishom("sight", "site").
ishom("route", "root").
ishom("berth", "birth").
ishom("check", "cheque").
ishom("hoard", "horde").
ishom("birth", "berth").
ishom("grate", "great").
ishom("bad", "bade").
ishom("faze", "phase").
ishom("manner", "manna").
ishom("brayed", "braid").
ishom("pair", "pear").
ishom("sauce", "seen").
ishom("bear", "bare").
ishom("awl", "all").
ishom("more", "maw").
ishom("draught", "draft").
ishom("file", "file").
ishom("die", "dye").
ishom("rose", "rows").
ishom("steel", "steal").
ishom("your", "yore").
ishom("course", "coarse").
ishom("pear", "pair").
ishom("forward", "foreword").
ishom("none", "nun").
ishom("idol", "idle").
ishom("bow", "bough").
ishom("reed", "read").
ishom("stalk", "stalk").
ishom("foul", "fowl").
ishom("wail", "whale").
ishom("not", "knot").
ishom("rain", "reign").
ishom("stationary", "stationery").
ishom("fair", "fare").
ishom("levy", "levee").
ishom("broach", "brooch").
ishom("beer", "bier").
ishom("nail", "nail").
ishom("foot", "foot").
ishom("vane", "vain").
ishom("waste", "waist").
ishom("yore", "your").
ishom("by", "bye").
ishom("left", "left").
ishom("bridle", "bridal").
ishom("where", "wear").
ishom("hymn", "him").
ishom("pain", "pane").
ishom("bored", "board").
ishom("shoo", "shoe").
ishom("fare", "fair").
ishom("drop", "drop").
ishom("bays", "baize").
ishom("heir", "air").
ishom("maw", "more").
ishom("mousse", "moose").
ishom("stalk", "stork").
ishom("rose", "rose").
ishom("see", "sea").
ishom("farther", "father").
ishom("chord", "cord").
ishom("then", "than").
ishom("ring", "wring").
ishom("teem", "team").
ishom("site", "sight").
ishom("i", "eye").
ishom("vain", "vane").
ishom("profit", "prophet").
ishom("incite", "insight").
ishom("vain", "vein").
ishom("hare", "hair").
ishom("fort", "fought").
ishom("sight", "cite").
ishom("feat", "feet").
ishom("gambol", "gamble").
ishom("discreet", "discrete").
ishom("team", "teem").
ishom("sweet", "suite").
ishom("banned", "band").
ishom("rap", "wrap").
ishom("feet", "feat").
ishom("fur", "fir").
ishom("chilly", "chili").
ishom("auger", "augur").
ishom("red", "read").
ishom("flex", "flecks").
ishom("tied", "tide").
ishom("buy", "by").
ishom("skull", "scull").
ishom("vane", "vein").
ishom("whole", "hole").
ishom("practise", "practice").
ishom("tier", "tear").
ishom("gored", "gourd").
ishom("full", "fool").
ishom("slay", "sleigh").
ishom("veil", "vale").
ishom("hair", "hare").
ishom("hi", "high").
ishom("pray", "prey").
ishom("bruise", "brews").
ishom("for", "four").
ishom("gate", "gait").
ishom("add", "ad").
ishom("past", "passed").
ishom("hear", "here").
ishom("aloud", "allowed").
ishom("you", "ewe").
ishom("our", "hour").
ishom("sent", "cent").
ishom("some", "sum").
ishom("brake", "break").
ishom("to", "two").
ishom("aunt", "ant").
ishom("ark", "arc").
ishom("mist", "missed").
ishom("cent", "sent").
ishom("pale", "pail").
ishom("beat", "beet").
ishom("palm", "palm").
ishom("their", "there").
ishom("cell", "sell").
ishom("two", "too").
ishom("might", "mite").
ishom("draft", "draught").
ishom("been", "bean").
ishom("reign", "rain").
ishom("patience", "patients").
ishom("date", "date").
ishom("barred", "bard").
ishom("tide", "tied").
ishom("maid", "made").
ishom("sail", "sale").
ishom("complement", "compliment").
ishom("great", "grate").
ishom("pane", "pain").
ishom("ale", "ail").
ishom("hole", "whole").
ishom("stake", "steak").
ishom("manna", "manner").
ishom("scene", "seen").
ishom("bard", "barred").
ishom("whose", "whos").
ishom("bail", "bale").
ishom("rode", "road").
ishom("clip", "clip").
ishom("wholly", "holy").
ishom("ail", "ale").
ishom("dough", "doe").
ishom("flue", "flu").
ishom("vein", "vain").
ishom("prey", "pray").
ishom("ceiling", "sealing").
ishom("to", "too").
ishom("duel", "dual").
ishom("suite", "sweet").
ishom("soot", "suit").
ishom("read", "red").
ishom("whos", "whose").
ishom("patients", "patience").
ishom("flecks", "flex").
ishom("fall", "fall").
ishom("principal", "principle").
ishom("through", "threw").
ishom("night", "knight").
ishom("stare", "stair").
ishom("berry", "bury").
ishom("mane", "main").
ishom("bough", "bow").
ishom("beach", "beech").
ishom("which", "witch").
ishom("toad", "towed").
ishom("four", "fore").
ishom("weight", "wait").
ishom("duck", "duck").
ishom("well", "well").
ishom("cheap", "cheep").
ishom("heart", "hart").
ishom("capital", "capitol").
ishom("told", "tolled").
ishom("pore", "pour").
ishom("right", "write").
ishom("waist", "waste").
ishom("plain", "plane").
ishom("suit", "soot").
ishom("leek", "leak").
ishom("mask", "masque").
ishom("towed", "toad").
ishom("scull", "skull").
ishom("peak", "peek").
ishom("knot", "not").
ishom("prays", "praise").
ishom("spring", "spring").
ishom("wear", "where").
ishom("cord", "chord").
ishom("foreword", "forward").
ishom("ball", "bawl").
ishom("youre", "your").
ishom("muscle", "mussel").
ishom("boy", "buoy").
ishom("knead", "need").
ishom("seem", "seam").
ishom("bawl", "ball").
ishom("principle", "principal").
ishom("quay", "key").
ishom("thrown", "throne").
ishom("soar", "sore").
ishom("mussel", "muscle").
ishom("prophet", "profit").
ishom("whether", "weather").
ishom("steak", "stake").
ishom("park", "park").
ishom("rock", "rock").
ishom("leak", "leek").
ishom("brews", "bruise").
ishom("fourth", "forth").
ishom("sink", "sink").
ishom("bald", "bawled").
ishom("bye", "by").
ishom("hall", "haul").
ishom("seam", "seem").
ishom("sought", "sort").
ishom("hire", "higher").
ishom("sighed", "side").
ishom("ring", "ring").
ishom("point", "point").
ishom("stork", "stalk").
ishom("son", "sun").
ishom("bean", "been").
ishom("know", "no").
ishom("read", "reed").
ishom("all", "awl").
ishom("root", "route").
ishom("ad", "add").
ishom("beet", "beat").
ishom("tale", "tail").
ishom("flaw", "floor").
ishom("flour", "flower").
ishom("peel", "peal").
ishom("bury", "berry").
ishom("vein", "vane").
ishom("led", "lead").
ishom("gamble", "gambol").
ishom("herd", "heard").
ishom("oar", "ore").
ishom("mail", "male").
ishom("moose", "mousse").
ishom("him", "hymn").
ishom("whale", "wail").

% gets all homonyms in list A and returns it in list L
% this is then checked to see if there is a common member between list L and B
ishom(A, B):- get_all_homonyms(A, [], L), common_member(L, B).
% ishom(A, B) :- ishom(B,A).
%
% ishom([to], [too, of, who, !]).
% ishom(A,B) :- ishom(B,A).
% ishom(A,B) :- ishom(A,C), ishom(C,B).

get_all_homonyms([], R, K) :- append([], R, K).
get_all_homonyms([LH|LT], R, K) :- !, ishom(LH, E), append(R, [E], S), get_all_homonyms(LT, S, K).

get_all_homonyms([_|LT], R, K) :- get_all_homonyms(LT, R, K).
% get_all_homonyms([too, asdfas, to, where], [], L).

common_member(X,Y) :-
   member(E,X),
   member(E,Y).

% funny("knock knock . who is there ? Nobel Prize . Nobel Prize who ? Nobel Winner !").
% funny("knock knock . who is there ? witch . witch who ? which one of you will give me some halloween candy ?").

% generate all consecutive sub-lists of S in X
%
% append/3
% https://www.swi-prolog.org/pldoc/man?predicate=append/3
% param1 and param2 get combined into param3
%
% \=    equivalent to not equals
% https://www.swi-prolog.org/pldoc/man?predicate=%5C%3D/2
%
% This is pretty much appending one word to X at a time until it matches funnyFirst as long as X is not []
substring(X,S) :- append(_,T,S), append(X,_,T) , X \= [].

funnyFirst([A, B, "."]) :- A=="knock", A==B. % first two words must be the same

funnySecond(["who", "is", "there", "?"]).% must match this exact list of words

funnyThird(S) :- last(S, ".").
% The | denotes a 'tail' or 'the rest of the list.'

% got this from stacked overflow
% https://stackoverflow.com/questions/16174681/how-to-delete-the-last-element-from-a-list-in-prolog
list_butlast([X|Xs], Ys) :-                 % use auxiliary predicate ...
   list_butlast_prev(Xs, Ys, X).            % ... which lags behind by one item

list_butlast_prev([], [], _).
list_butlast_prev([X1|Xs], [X0|Ys], X0) :-
   list_butlast_prev(Xs, Ys, X1).           % lag behind by one

% must end with "who?"
funnyFourth(S) :- last(S, "?"), list_butlast(S, X), last(X, "who").

% the main context must match word for word. ie -'.' from third and -'who?' from fourth
checkThirdFourth(Third, Fourth) :- same(Third, Fourth).
same([], []).
same([H1|T1], [H2|T2]):-
    H1 = H2,
    same(T1, T2).

funnyMain(L) :-  substring(First,L),
  funnyFirst(First),
  append(First,Rest,L),

  substring(Second,Rest),
  funnySecond(Second),
  append(Second,Rest2,Rest),

  substring(Third,Rest2),
  funnyThird(Third),
  append(Third,Rest3,Rest2),

  list_butlast(Third, NewThird),

  substring(Fourth,Rest3),
  funnyFourth(Fourth),
  append(Fourth,Rest4,Rest3),

  list_butlast(Fourth, NewFourth),
  list_butlast(NewFourth, NewNewFourth),

  checkThirdFourth(NewThird, NewNewFourth),

  ishom(NewThird, Rest4),
  writeln('true')
  .

% ==== function docs ====
% string_split/4
% https://www.swi-prolog.org/pldoc/man?predicate=split_string/4
% This is ideally splitting up the sentence into a list to be processed
%
% write/1
% https://www.swi-prolog.org/pldoc/man?predicate=write/1
%
% writeln/1
% https://www.swi-prolog.org/pldoc/man?predicate=writeln/1
funny(S) :- split_string(S, " ", " ", L), funnyMain(L).
